(this["webpackJsonpclient-laraigo"]=this["webpackJsonpclient-laraigo"]||[]).push([[109],{1052:function(e,t,a){"use strict";a.r(t),a.d(t,"DetailTipification",(function(){return M}));var n=a(24),i=a.n(n),c=a(39),o=a(3),l=a(1),r=a(26),s=a(20),d=a(0),u=a.n(d),j=a(25),b=a(40),v=a(94),f=a(48),p=a(7),O=a(779),m=a(169),h=a(780),g=a.n(h),x=a(122),y=a(8),C=a(807),I=a.n(C),w=a(966),N=a.n(w),D=a(205),S=a(83),T=a(44),F=a(778),k=a.n(F),_=a(786),A=a.n(_),E=a(257),R=a(265),V=a.n(R),L=a(965),z=a.n(L),H=a(1390),q=a(1391),B=a(46),P=a(10),G=a(2),J=Object(m.a)((function(e){return{containerDetail:{marginTop:e.spacing(2),padding:e.spacing(2),background:"#fff"},button:{padding:12,fontWeight:500,fontSize:"14px",textTransform:"initial"},title:{fontSize:"22px",lineHeight:"48px",height:"48px",color:e.palette.text.primary},halfplace:{width:"50%"},dataaction:{width:"100%",paddingBottom:"20px"},treeviewroot:{height:240,flexGrow:1,maxWidth:400}}})),K=[{dat:"Simple"},{dat:"Variable"},{dat:"Request"}],U=function(e){var t=e.dataClassTotal,a=[],n=[];function i(e){return n.map((function(t){return t.father===e?Object(G.jsx)(H.a,{nodeId:String(t.nodeId),label:t.label,children:t.children?i(t.key):null},t.key):null}))}return t.forEach((function(e){if(0===e.parent){var t={key:e.classificationid,nodeId:e.classificationid.toString(),label:e.description.toString(),children:e.haschildren};a.push(t)}else{var i,c,o={key:e.classificationid,nodeId:null===(i=e.classificationid)||void 0===i?void 0:i.toString(),label:null===(c=e.description)||void 0===c?void 0:c.toString(),children:e.haschildren,father:e.parent};n.push(o)}})),Object(G.jsx)(G.Fragment,{children:a.map((function(e){return Object(G.jsx)(H.a,{nodeId:String(e.nodeId),label:e.label,children:e.children?i(e.key):null},e.key)}))})},M=function(e){var t,a,n,i,c,O,m,h,C,I=e.data,w=I.row,N=I.edit,F=e.setViewSelected,_=e.multiData,R=e.fetchData,L=e.externalUse,z=void 0!==L&&L,H=e.externalType,q=e.externalSaveHandler,B=e.externalCancelHandler,P=e.arrayBread,U=J(),M=Object(d.useState)(!1),W=Object(s.a)(M,2),Q=W[0],X=W[1],Y=Object(d.useState)((null===w||void 0===w?void 0:w.description)||""),Z=Object(s.a)(Y,2),$=Z[0],ee=Z[1],te=Object(d.useState)((null===w||void 0===w?void 0:w.order)||""),ae=Object(s.a)(te,2),ne=ae[0],ie=ae[1],ce=Object(d.useState)(z?H:(null===w||void 0===w?void 0:w.type)||"TIPIFICACION"),oe=Object(s.a)(ce,2),le=oe[0],re=oe[1],se=Object(d.useState)({communicationchannel:(null===w||void 0===w?void 0:w.communicationchannel)||"",tags:(null===w||void 0===w?void 0:w.tags)||"",order:(null===w||void 0===w?void 0:w.order)||"",parent:(null===w||void 0===w?void 0:w.parentid)||0}),de=Object(s.a)(se,2),ue=de[0],je=de[1],be=Object(d.useState)(!!(null===w||void 0===w?void 0:w.jobplan)||!1),ve=Object(s.a)(be,2),fe=ve[0],pe=ve[1],Oe=Object(d.useState)(w&&w.jobplan?JSON.parse(w.jobplan):[]),me=Object(s.a)(Oe,2),he=me[0],ge=me[1],xe=Object(j.b)((function(e){return e.main.execute})),ye=Object(b.c)(),Ce=Object(x.a)().t,Ie=_[0]&&_[0].success?_[0].data:[],we=_[3]&&_[3].success?_[3].data.filter((function(e){return e.type===le})):[];console.log(we);var Ne=_[2]&&_[2].success?_[2].data:[],De=_[4]&&_[4].success?_[4].data:[],Se=Object(D.d)({defaultValues:{type:z?H:(null===w||void 0===w?void 0:w.type)||"TIPIFICACION",id:(null===w||void 0===w?void 0:w.classificationid)||0,description:N?null===w||void 0===w?void 0:w.description:"",title:(null===w||void 0===w?void 0:w.title)||"",parent:(null===w||void 0===w?void 0:w.parentid)||0,communicationchannel:(null===w||void 0===w?void 0:w.communicationchannel)||"",status:(null===w||void 0===w?void 0:w.status)||"ACTIVO",operation:w?"EDIT":"INSERT",path:(null===w||void 0===w?void 0:w.path)||"",tags:(null===w||void 0===w?void 0:w.tags)||"",order:(null===w||void 0===w?void 0:w.order)||"",metacatalogid:(null===w||void 0===w?void 0:w.metacatalogid)||0}}),Te=Se.register,Fe=Se.handleSubmit,ke=Se.setValue,_e=Se.getValues,Ae=Se.formState.errors;function Ee(e,t,a){ge((function(n){return n.map((function(n,i){return i===a?Object(l.a)(Object(l.a)({},n),{},Object(o.a)({},e,t)):n}))}))}u.a.useEffect((function(){Te("id"),Te("title",{validate:{noempty:function(e){return e&&e.length||Ce(y.a.field_required)},limit:function(e){return"CATEGORIA"!==_e("type")||(e&&e.length&&e.length<=20||Ce(y.a.limit20char))}}}),Te("description",{validate:{noempty:function(e){return e&&e.length||Ce(y.a.field_required)},limit:function(e){return"CATEGORIA"!==_e("type")||(e&&e.length&&e.length<=75||Ce(y.a.limit20char))}}}),Te("parent"),Te("communicationchannel",{validate:{typeclassification:function(e){return"CATEGORIA"===_e("type")||(e&&e.length||Ce(y.a.field_required))}}}),Te("status",{validate:function(e){return e&&e.length||Ce(y.a.field_required)}}),Te("type",{validate:function(e){return e&&e.length||Ce(y.a.field_required)}}),Te("path"),Te("tags"),Te("order"),Te("metacatalogid")}),[N,Te]),Object(d.useEffect)((function(){if(Q)if(xe.loading||xe.error){if(xe.error){var e=Ce(xe.code||"error_unexpected_error",{module:Ce(y.a.classification).toLocaleLowerCase()});ye(Object(T.e)({show:!0,severity:"error",message:e})),ye(Object(T.d)(!1)),X(!1)}}else z?(ye(Object(T.e)({show:!0,severity:"success",message:Ce(w?y.a.successful_edit:y.a.successful_register)})),ye(Object(T.d)(!1)),q&&q()):(ye(Object(T.e)({show:!0,severity:"success",message:Ce(w?y.a.successful_edit:y.a.successful_register)})),R(),ye(Object(T.d)(!1)),F("view-1"))}),[xe,Q]);var Re=Fe((function(e){ye(Object(T.a)({visible:!0,question:Ce(y.a.confirmation_save),callback:function(){ye(Object(S.c)(Object(p.Kf)(Object(l.a)(Object(l.a)({},e),{},{jobplan:JSON.stringify(he),order:ne||"1"})))),ye(Object(T.d)(!0)),X(!0)}}))}));return Object(G.jsx)("div",{style:{width:"100%"},children:Object(G.jsxs)("form",{onSubmit:Re,children:[Object(G.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[z?Object(G.jsx)("div",{}):Object(G.jsxs)("div",{children:[Object(G.jsx)(f.L,{breadcrumbs:[].concat(Object(r.a)(P),[{id:"view-2",name:"".concat(Ce(y.a.tipification)," ").concat(Ce(y.a.detail))}]),handleClick:F}),Object(G.jsx)(f.R,{title:w?"".concat(w.title):Ce(y.a.tipification)})]}),Object(G.jsxs)("div",{style:{display:"flex",gap:"10px",alignItems:"center"},children:[Object(G.jsx)(v.a,{variant:"contained",type:"button",color:"primary",startIcon:Object(G.jsx)(k.a,{color:"secondary"}),style:{backgroundColor:"#FB5F5F"},onClick:function(){z?B&&B():F("view-1")},children:Ce(y.a.back)}),N&&Object(G.jsx)(v.a,{className:U.button,variant:"contained",color:"primary",type:"submit",startIcon:Object(G.jsx)(g.a,{color:"secondary"}),style:{backgroundColor:"#55BD84"},children:Ce(y.a.save)})]})]}),Object(G.jsxs)("div",{className:U.containerDetail,children:[Object(G.jsxs)("div",{className:"row-zyx",children:[Object(G.jsx)(f.l,{label:Ce(y.a.classification),className:"col-6",onChange:function(e){return ke("title",e)},valueDefault:(null===w||void 0===w?void 0:w.title)||"",error:null===Ae||void 0===Ae||null===(t=Ae.title)||void 0===t?void 0:t.message}),Object(G.jsx)("div",{className:"col-6",style:{position:"relative"},children:Object(G.jsxs)(G.Fragment,{children:[Object(G.jsx)(f.l,{label:Ce(y.a.description),onChange:function(e){ee(e),ke("description",e)},valueDefault:$,error:null===Ae||void 0===Ae||null===(a=Ae.description)||void 0===a?void 0:a.message}),Object(G.jsx)(f.j,{bottom:-370,style:{position:"absolute",top:"25px",display:"flex",justifyContent:"end",right:16},onSelect:function(e){ee($+e.native),ke("description",$+e.native)}})]})})]}),Object(G.jsxs)("div",{className:"row-zyx",children:[Object(G.jsx)(f.u,{label:Ce(y.a.parent),className:"col-6",valueDefault:ue.parent,onChange:function(e){ke("parent",(null===e||void 0===e?void 0:e.classificationid)||0),je(Object(l.a)(Object(l.a)({},ue),{},{parent:(null===e||void 0===e?void 0:e.classificationid)||0}))},error:null===Ae||void 0===Ae||null===(n=Ae.parent)||void 0===n?void 0:n.message,data:we,optionDesc:"description",optionValue:"classificationid"}),Object(G.jsx)(f.l,{label:Ce(y.a.path),className:"col-6",valueDefault:(null===w||void 0===w?void 0:w.path)||"",onChange:function(e){return ke("path",e)},error:null===Ae||void 0===Ae||null===(i=Ae.path)||void 0===i?void 0:i.message,disabled:!0})]}),Object(G.jsxs)("div",{className:"row-zyx",children:[Object(G.jsx)(f.u,{label:Ce(y.a.status),className:"col-6",valueDefault:(null===w||void 0===w?void 0:w.status)||"ACTIVO",onChange:function(e){return ke("status",(null===e||void 0===e?void 0:e.domainvalue)||"")},error:null===Ae||void 0===Ae||null===(c=Ae.status)||void 0===c?void 0:c.message,data:Ie,uset:!0,prefixTranslation:"status_",optionDesc:"domaindesc",optionValue:"domainvalue"}),!z&&Object(G.jsx)(f.u,{label:Ce(y.a.type),className:"col-6",valueDefault:le,onChange:function(e){ke("communicationchannel",""),ke("tags",""),ke("order",""),ke("parent",0),je({communicationchannel:"",tags:"",order:"",parent:0}),ke("type",(null===e||void 0===e?void 0:e.value)||""),re((null===e||void 0===e?void 0:e.value)||"")},error:null===Ae||void 0===Ae||null===(O=Ae.type)||void 0===O?void 0:O.message,data:[{value:"CATEGORIA",desc:Ce(y.a.category)},{value:"TIPIFICACION",desc:Ce(y.a.tipification)}],uset:!0,optionDesc:"desc",optionValue:"value"})]}),("TIPIFICACION"===le||z)&&Object(G.jsxs)("div",{className:"row-zyx",children:[Object(G.jsx)(f.q,{label:Ce(y.a.channel_plural),className:"col-6",onChange:function(e){ke("communicationchannel",e.map((function(e){return e.domainvalue})).join()),je(Object(l.a)(Object(l.a)({},ue),{},{communicationchannel:e.map((function(e){return e.domainvalue})).join()}))},valueDefault:ue.communicationchannel,error:null===Ae||void 0===Ae||null===(m=Ae.communicationchannel)||void 0===m?void 0:m.message,data:Ne,optionDesc:"domaindesc",optionValue:"domainvalue"}),Object(G.jsx)(f.l,{label:Ce(y.a.tag),className:"col-6",valueDefault:(null===w||void 0===w?void 0:w.tags)||"",onChange:function(e){return ke("tags",e)},error:null===Ae||void 0===Ae||null===(h=Ae.tags)||void 0===h?void 0:h.message})]}),"CATEGORIA"===le&&Object(G.jsx)(G.Fragment,{children:Object(G.jsxs)("div",{className:"row-zyx",children:[Object(G.jsx)(f.l,{label:Ce(y.a.order),className:"col-6",type:"number",valueDefault:ne,error:null===Ae||void 0===Ae||null===(C=Ae.order)||void 0===C?void 0:C.message,onChange:function(e){ie(e),ke("order",e)},InputProps:{inputProps:{min:1,step:"1"}}}),Object(G.jsx)(f.u,{label:Ce(y.a.catalogmaster),className:"col-6",valueDefault:(null===w||void 0===w?void 0:w.metacatalogid)||0,onChange:function(e){ke("metacatalogid",(null===e||void 0===e?void 0:e.metacatalogid)||0)},data:De,optionDesc:"catalogname",optionValue:"metacatalogid"})]})}),("TIPIFICACION"===le||z)&&Object(G.jsxs)(G.Fragment,{children:[Object(G.jsxs)("div",{style:{marginBottom:"16px"},children:[Object(G.jsx)("div",{className:U.title,children:Ce(y.a.actionplan)}),Object(G.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[N?Object(G.jsx)(f.N,{label:Ce(y.a.hasactionplan),valueDefault:fe?"x":"",onChange:function(e){return pe(e)}}):Object(G.jsx)(f.v,{label:Ce(y.a.default_organization),value:w&&w.bydefault?Ce(y.a.affirmative):Ce(y.a.negative)}),N&&fe&&Object(G.jsx)("div",{children:Object(G.jsx)(v.a,{variant:"contained",type:"button",color:"primary",endIcon:Object(G.jsx)(A.a,{style:{color:"#deac32"}}),style:{backgroundColor:"#6c757d"},onClick:function(){ge((function(e){return[].concat(Object(r.a)(e),[{action:"",type:"Simple"}])}))},children:Ce(y.a.action)})})]}),N&&fe&&he.map((function(e,t){var a;return Object(G.jsxs)("div",{className:"row-zyx",children:[Object(G.jsx)(f.l,{label:Ce(y.a.action),className:"col-6",valueDefault:e.action?e.action:"",onChange:function(e){return Ee("action",e,t)}}),Object(G.jsx)(f.u,{label:Ce(y.a.type),className:"col-5",valueDefault:e.type?e.type:"Simple",error:null===Ae||void 0===Ae||null===(a=Ae.status)||void 0===a?void 0:a.message,data:K,optionDesc:"dat",optionValue:"dat",onChange:function(e){return Ee("type",e.dat,t)}}),Object(G.jsx)("div",{className:"col-1",style:{paddingTop:"15px"},children:Object(G.jsx)(E.a,{"aria-label":"delete",onClick:function(){return function(e){ge(he.filter((function(t,a){return a!==e})))}(t)},children:Object(G.jsx)(V.a,{})})}),"Variable"===e.type?Object(G.jsx)(f.l,{label:Ce(y.a.variable),className:U.dataaction,valueDefault:e.variable?e.variable:"",onChange:function(e){return Ee("variable",e,t)}}):null,"Request"===e.type?Object(G.jsxs)("div",{children:[Object(G.jsx)(f.l,{label:Ce(y.a.endpoint),className:U.dataaction,valueDefault:e.endpoint?e.endpoint:"",onChange:function(e){return Ee("endpoint",e,t)}}),Object(G.jsx)(f.o,{label:Ce(y.a.data),className:U.dataaction,valueDefault:e.data?e.data:"",onChange:function(e){return Ee("data",e,t)},maxLength:2048})]}):null,Object(G.jsx)("hr",{})]},t)}))]}),Object(G.jsx)("div",{style:{display:"flex",gap:"10px",justifyContent:"flex-end"}})]})]})]})})};t.default=function(){var e=Object(B.g)(),t=Object(b.c)(),a=Object(x.a)().t,n=Object(j.b)((function(e){return e.main})),r=Object(j.b)((function(e){return e.main.execute})),m=J(),h=Object(d.useState)(!1),g=Object(s.a)(h,2),C=g[0],w=g[1],D=Object(d.useState)(!1),F=Object(s.a)(D,2),_=F[0],A=F[1],E=Object(d.useState)("view-1"),R=Object(s.a)(E,2),V=R[0],L=R[1],H=Object(d.useState)({row:null,edit:!1}),K=Object(s.a)(H,2),W=K[0],Q=K[1],X=Object(d.useState)(!1),Y=Object(s.a)(X,2),Z=Y[0],$=Y[1],ee=[{id:"view-0",name:a(y.a.configuration_plural)},{id:"view-1",name:a(y.a.classification_plural)}];function te(t){"view-0"!==t?L(t):e.push(P.a.CONFIGURATION)}var ae=u.a.useMemo((function(){return[{accessor:"classificationid",NoFilter:!0,isComponent:!0,minWidth:60,width:"1%",Cell:function(e){var t=e.cell.row.original;return Object(G.jsx)(f.M,{viewFunction:function(){return ie(t)},deleteFunction:function(){return oe(t)},editFunction:function(){return ce(t)}})}},{Header:a(y.a.title),accessor:"title",NoFilter:!0},{Header:a(y.a.description),accessor:"description",NoFilter:!0},{Header:a(y.a.type),accessor:"type",prefixTranslation:"type_",NoFilter:!0,Cell:function(e){var t=e.cell.row.original.type;return(a("type_".concat(t))||"").toUpperCase()}},{Header:a(y.a.parent),accessor:"parentdesc",NoFilter:!0},{Header:a(y.a.order),accessor:"order",NoFilter:!0},{Header:a(y.a.tag),accessor:"tags",NoFilter:!0},{Header:a(y.a.channel),accessor:"communicationchanneldesc",NoFilter:!0},{Header:a(y.a.status),accessor:"statusdesc",NoFilter:!0,prefixTranslation:"status_",Cell:function(e){var t=e.cell.row.original.status;return(a("status_".concat(t).toLowerCase())||"").toUpperCase()}}]}),[]),ne=function(){t(Object(S.g)(Object(p.pc)(0))),t(Object(S.p)([Object(p.Ke)("ESTADOGENERICO"),Object(p.Ld)(),Object(p.Ke)("TIPOCANAL"),Object(p.Je)("TIPIFICACION"),Object(p.ic)()]))};Object(d.useEffect)((function(){return ne(),function(){t(Object(S.t)())}}),[]),Object(d.useEffect)((function(){if(Z)if(r.loading||r.error){if(r.error){var e=a(r.code||"error_unexpected_error",{module:a(y.a.tipification).toLocaleLowerCase()});t(Object(T.e)({show:!0,severity:"error",message:e})),t(Object(T.d)(!1)),$(!1)}}else t(Object(T.e)({show:!0,severity:"success",message:a(_?y.a.successful_edit:y.a.successful_delete)})),A(!1),ne(),t(Object(T.d)(!1)),$(!1)}),[r,Z]);var ie=function(e){L("view-2"),Q({row:e,edit:!1})},ce=function(e){L("view-2"),Q({row:e,edit:!0})},oe=function(e){t(Object(T.a)({visible:!0,question:a(y.a.confirmation_delete),callback:function(){t(Object(S.c)(Object(p.Kf)(Object(l.a)(Object(l.a)({},e),{},{operation:"DELETE",status:"ELIMINADO",id:e.classificationid,parent:e.parentid})))),t(Object(T.d)(!0)),$(!0)}}))},le=function(){var e=Object(c.a)(i.a.mark((function e(c){var r,s;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=c[0])){e.next=7;break}return e.next=4,Object(p.rh)(r,void 0);case 4:(s=(s=e.sent).filter((function(e){return!["",null,void 0].includes(e.classification)&&!["",null,void 0].includes(e.channels)&&(["",null,void 0].includes(e.parent)||Object.keys(n.multiData.data[1].data.reduce((function(e,t){return Object(l.a)(Object(l.a)({},e),{},Object(o.a)({},t.classificationid,t.title))}),{0:""})).includes(""+e.parent))}))).length>0?(t(Object(T.d)(!0)),t(Object(S.c)({header:null,detail:s.map((function(e){return Object(p.Kf)(Object(l.a)(Object(l.a)({},e),{},{title:e.classification,description:e.description,communicationchannel:e.channels,tags:e.tag||"",parent:e.parent||0,operation:"INSERT",type:"TIPIFICACION",oder:"1",status:e.status||"ACTIVO",id:0}))}))},!0)),A(!0),$(!0)):t(Object(T.e)({show:!0,severity:"error",message:a(y.a.error_invaliddata)}));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return"view-1"===V?n.mainData.error?Object(G.jsx)("h1",{children:"ERROR"}):Object(G.jsxs)("div",{style:{width:"100%"},children:[Object(G.jsx)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:Object(G.jsx)(f.L,{breadcrumbs:ee,handleClick:te})}),Object(G.jsxs)(d.Fragment,{children:[Object(G.jsx)(O.f,{columns:ae,titlemodule:a(y.a.tipification,{count:2}),data:n.mainData.data,loading:n.mainData.loading,download:!0,register:!0,onClickRow:ce,importCSV:le,handleTemplate:function(){var e=[{},{},n.multiData.data[2].data.reduce((function(e,t){return Object(l.a)(Object(l.a)({},e),{},Object(o.a)({},t.domainvalue,t.domaindesc))}),{}),{},n.multiData.data[3].data.reduce((function(e,t){return Object(l.a)(Object(l.a)({},e),{},Object(o.a)({},t.classificationid,t.description))}),{0:""}),n.multiData.data[0].data.reduce((function(e,t){return Object(l.a)(Object(l.a)({},e),{},Object(o.a)({},t.domainvalue,t.domainvalue))}),{})];Object(p.bb)(a(y.a.template),Object(p.fh)(e,["classification","description","channels","tag","parent","status"]))},handleRegister:function(){L("view-2"),Q({row:null,edit:!0})},ButtonsElement:function(){return Object(G.jsxs)(G.Fragment,{children:[Object(G.jsx)(v.a,{variant:"contained",type:"button",color:"primary",startIcon:Object(G.jsx)(k.a,{color:"secondary"}),style:{backgroundColor:"#FB5F5F"},onClick:function(){return e.push(P.a.CONFIGURATION)},children:a(y.a.back)}),Object(G.jsx)(v.a,{variant:"contained",type:"button",color:"primary",style:{backgroundColor:"#7721ad"},onClick:function(){return w(!0)},startIcon:Object(G.jsx)(z.a,{color:"secondary"}),children:a(y.a.opendrilldown)})]})}}),Object(G.jsxs)(f.g,{open:C,title:a(y.a.organizationclass),buttonText1:a(y.a.close),handleClickButton1:function(){return w(!1)},handleClickButton2:function(){return w(!1)},children:[Object(G.jsx)(q.a,{className:m.treeviewroot,defaultCollapseIcon:Object(G.jsx)(I.a,{}),defaultExpandIcon:Object(G.jsx)(N.a,{}),children:Object(G.jsx)(U,{dataClassTotal:n.multiData.data[3]&&n.multiData.data[3].success?n.multiData.data[3].data:[]})}),Object(G.jsx)("div",{className:"row-zyx"})]})]})]}):"view-2"===V?Object(G.jsx)(M,{data:W,setViewSelected:te,multiData:n.multiData.data,fetchData:ne,arrayBread:ee}):null}}}]);
//# sourceMappingURL=109.17895ff2.chunk.js.map