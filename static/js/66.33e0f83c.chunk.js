(this["webpackJsonpclient-laraigo"]=this["webpackJsonpclient-laraigo"]||[]).push([[66],{1253:function(e,t,a){"use strict";var i=a(45),l=a(61);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=l(a(0)),n=(0,i(a(62)).default)(r.createElement("path",{d:"M21 10.12h-6.78l2.74-2.82c-2.73-2.7-7.15-2.8-9.88-.1-2.73 2.71-2.73 7.08 0 9.79s7.15 2.71 9.88 0C18.32 15.65 19 14.08 19 12.1h2c0 1.98-.88 4.55-2.64 6.29-3.51 3.48-9.21 3.48-12.72 0-3.5-3.47-3.53-9.11-.02-12.58s9.14-3.47 12.65 0L21 3v7.12zM12.5 8v4.25l3.5 2.08-.72 1.21L11 13V8h1.5z"}),"Update");t.default=n},1419:function(e,t,a){"use strict";a.r(t);var i=a(1),l=a(20),r=a(0),n=a.n(r),c=a(25),o=a(40),d=a(94),s=a(48),u=a(7),v=a(779),j=a(169),b=a(780),O=a.n(b),m=a(122),p=a(718),f=a(8),h=a(205),g=a(83),x=a(44),y=a(778),k=a.n(y),w=a(776),D=a(51),_=a(102),N=a(1047),C=a(1048),S=a(1146),E=a(1044),M=a(1045),q=a(1049),L=a(257),I=a(167),T=a(197),A=a(447),z=a(16),F=a(1086),P=a.n(F),K=a(830),R=a(326),V=a.n(R),H=a(265),B=a.n(H),U=a(1253),W=a.n(U),Z=a(2),Y=Object(j.a)((function(e){return{containerDetail:{marginTop:e.spacing(2),padding:e.spacing(2),background:"#fff"},button:{padding:12,fontWeight:500,fontSize:"14px",textTransform:"initial"},mb2:{marginBottom:e.spacing(4)}}})),G={MINUTE:"minute",HOUR:"hour",DAY:"day",MONTH:"month"},J=function(e){var t,a,j,b,y,L,I,T,A,F,R,V,H,B=e.data,U=B.row,W=B.edit,J=e.setViewSelected,X=e.multiData,Q=e.fetchData,$=Object(c.b)((function(e){return e.login.validateToken.user})),ee=Y(),te=Object(r.useState)(!1),ae=Object(l.a)(te,2),ie=ae[0],le=ae[1],re=Object(c.b)((function(e){return e.main.execute})),ne=Object(c.b)((function(e){return e.main.mainAux})),ce=Object(c.b)((function(e){return e.main.mainAux2})),oe=Object(o.c)(),de=Object(m.a)().t,se=Object(r.useState)(0),ue=Object(l.a)(se,2),ve=ue[0],je=ue[1],be=X[0]&&X[0].success?X[0].data:[],Oe=Object(h.d)({defaultValues:{id:(null===U||void 0===U?void 0:U.id)||0,kpiname:(null===U||void 0===U?void 0:U.kpiname)||"",description:(null===U||void 0===U?void 0:U.description)||"",status:(null===U||void 0===U?void 0:U.status)||"ACTIVO",type:(null===U||void 0===U?void 0:U.type)||"",sqlselect:(null===U||void 0===U?void 0:U.sqlselect)||"",sqlwhere:(null===U||void 0===U?void 0:U.sqlwhere)||"",target:(null===U||void 0===U?void 0:U.target)||0,cautionat:(null===U||void 0===U?void 0:U.cautionat)||0,alertat:(null===U||void 0===U?void 0:U.alertat)||0,taskperiod:(null===U||void 0===U?void 0:U.taskperiod)||"DAY",taskinterval:(null===U||void 0===U?void 0:U.taskinterval)||1,taskstartdate:U?new Date(new Date(null===U||void 0===U?void 0:U.taskstartdate).getTime()-6e4*(new Date).getTimezoneOffset()).toISOString():(new Date).toISOString(),previousvalue:null===U||void 0===U?void 0:U.previousvalue,currentvalue:null===U||void 0===U?void 0:U.currentvalue,updatedate:null===U||void 0===U?void 0:U.updatedate,createdate:null===U||void 0===U?void 0:U.createdate,createby:null===U||void 0===U?void 0:U.createby,changedate:null===U||void 0===U?void 0:U.changedate,changeby:null===U||void 0===U?void 0:U.changeby,operation:U&&U.id?"EDIT":"INSERT"}}),me=Oe.register,pe=Oe.reset,fe=Oe.handleSubmit,he=Oe.setValue,ge=Oe.getValues,xe=Oe.formState.errors,ye=Object(r.useState)({previousvalue:null===U||void 0===U?void 0:U.previousvalue,currentvalue:null===U||void 0===U?void 0:U.currentvalue,updatedate:null===U||void 0===U?void 0:U.updatedate,target:null===U||void 0===U?void 0:U.target,cautionat:null===U||void 0===U?void 0:U.cautionat,alertat:null===U||void 0===U?void 0:U.alertat}),ke=Object(l.a)(ye,2),we=ke[0],De=ke[1],_e=Object(r.useState)([0,0,0]),Ne=Object(l.a)(_e,2),Ce=Ne[0],Se=Ne[1];Object(r.useEffect)((function(){we&&(we.target<=we.alertat?Se([we.cautionat/Math.max(null===we||void 0===we?void 0:we.currentvalue,10*Math.ceil(1.2*we.alertat/10)),(we.alertat-we.cautionat)/Math.max(null===we||void 0===we?void 0:we.currentvalue,10*Math.ceil(1.2*we.alertat/10)),(Math.max(null===we||void 0===we?void 0:we.currentvalue,10*Math.ceil(1.2*we.alertat/10))-we.alertat)/Math.max(null===we||void 0===we?void 0:we.currentvalue,10*Math.ceil(1.2*we.alertat/10))]):Se([we.alertat/Math.max(null===we||void 0===we?void 0:we.currentvalue,10*Math.ceil(1.2*we.target/10)),(we.cautionat-we.alertat)/Math.max(null===we||void 0===we?void 0:we.currentvalue,10*Math.ceil(1.2*we.target/10)),(Math.max(null===we||void 0===we?void 0:we.currentvalue,10*Math.ceil(1.2*we.target/10))-we.cautionat)/Math.max(null===we||void 0===we?void 0:we.currentvalue,10*Math.ceil(1.2*we.target/10))]))}),[we]),n.a.useEffect((function(){me("kpiname",{validate:function(e){return e&&e.length||de(f.a.field_required)}}),me("description",{validate:function(e){return e&&e.length||de(f.a.field_required)}}),me("status",{validate:function(e){return e&&e.length||de(f.a.field_required)}}),me("sqlselect",{validate:function(e){return e&&e.length||de(f.a.field_required)}}),me("sqlwhere",{validate:function(e){return e&&e.length||de(f.a.field_required)}}),me("taskperiod",{validate:function(e){return e&&e.length||de(f.a.field_required)}}),me("taskinterval",{validate:function(e){return e&&e>0||de(f.a.field_required)}}),me("taskstartdate",{validate:function(e){return e&&e.length||de(f.a.field_required)}})}),[W,me]),Object(r.useEffect)((function(){return(null===U||void 0===U?void 0:U.id)&&(oe(Object(x.d)(!0)),oe(Object(g.i)(Object(u.Zg)(U.id)))),function(){oe(Object(g.z)()),oe(Object(g.A)())}}),[]),Object(r.useEffect)((function(){var e,t,a,i,l,r,n,c,o,d,s,v,j,b,O,m,p,f,h,g,y,k,w,D,_,N,C,S,E;!ce.loading&&!ce.error&&(null===(e=ce.data)||void 0===e?void 0:e.length)>0?(pe({id:(null===(t=ce.data[0])||void 0===t?void 0:t.id)||0,kpiname:(null===(a=ce.data[0])||void 0===a?void 0:a.kpiname)||"",description:(null===(i=ce.data[0])||void 0===i?void 0:i.description)||"",status:(null===(l=ce.data[0])||void 0===l?void 0:l.status)||"ACTIVO",type:(null===(r=ce.data[0])||void 0===r?void 0:r.type)||"",sqlselect:(null===(n=ce.data[0])||void 0===n?void 0:n.sqlselect)||"",sqlwhere:(null===(c=ce.data[0])||void 0===c?void 0:c.sqlwhere)||"",target:(null===(o=ce.data[0])||void 0===o?void 0:o.target)||0,cautionat:(null===(d=ce.data[0])||void 0===d?void 0:d.cautionat)||0,alertat:(null===(s=ce.data[0])||void 0===s?void 0:s.alertat)||0,taskperiod:(null===(v=ce.data[0])||void 0===v?void 0:v.taskperiod)||"DAY",taskinterval:(null===(j=ce.data[0])||void 0===j?void 0:j.taskinterval)||1,taskstartdate:(null===(b=ce.data[0])||void 0===b?void 0:b.taskstartdate)?new Date(new Date(null===(O=ce.data[0])||void 0===O?void 0:O.taskstartdate).getTime()-6e4*(new Date).getTimezoneOffset()).toISOString():(new Date).toISOString(),previousvalue:null===(m=ce.data[0])||void 0===m?void 0:m.previousvalue,currentvalue:null===(p=ce.data[0])||void 0===p?void 0:p.currentvalue,updatedate:null===(f=ce.data[0])||void 0===f?void 0:f.updatedate,createdate:null===(h=ce.data[0])||void 0===h?void 0:h.createdate,createby:null===(g=ce.data[0])||void 0===g?void 0:g.createby,changedate:null===(y=ce.data[0])||void 0===y?void 0:y.changedate,changeby:null===(k=ce.data[0])||void 0===k?void 0:k.changeby,operation:(null===(w=ce.data[0])||void 0===w?void 0:w.id)?"EDIT":"INSERT"}),De({previousvalue:null===(D=ce.data[0])||void 0===D?void 0:D.previousvalue,currentvalue:null===(_=ce.data[0])||void 0===_?void 0:_.currentvalue,updatedate:Object(u.K)(null===(N=ce.data[0])||void 0===N?void 0:N.updatedate).toLocaleString(void 0,{year:"numeric",month:"2-digit",day:"2-digit",hour:"numeric",minute:"numeric",second:"numeric"}),target:(null===(C=ce.data[0])||void 0===C?void 0:C.target)||0,cautionat:(null===(S=ce.data[0])||void 0===S?void 0:S.cautionat)||0,alertat:(null===(E=ce.data[0])||void 0===E?void 0:E.alertat)||0}),oe(Object(x.d)(!1))):re.error&&oe(Object(x.d)(!1))}),[ce]),Object(r.useEffect)((function(){if(ie)if(re.loading||re.error){if(re.error){var e=de(re.code||"error_unexpected_error",{module:de(f.a.kpimanager_plural).toLocaleLowerCase()});oe(Object(x.e)({show:!0,severity:"error",message:e})),le(!1),oe(Object(x.d)(!1))}}else oe(Object(x.e)({show:!0,severity:"success",message:de(U?f.a.successful_edit:f.a.successful_register)})),Q&&Q(),oe(Object(x.d)(!1)),J("view-1")}),[re,ie]);var Ee=fe((function(e){oe(Object(x.a)({visible:!0,question:de(f.a.confirmation_save),callback:function(){oe(Object(g.c)(Object(u.Zf)(e))),oe(Object(x.d)(!0)),le(!0)}}))})),Me=n.a.useMemo((function(){return[{Header:de(f.a.value),accessor:"currentvalue",NoFilter:!0},{Header:de(f.a.date),accessor:"createdate",NoFilter:!0}]}),[]),qe=Object(r.useState)(!1),Le=Object(l.a)(qe,2),Ie=Le[0],Te=Le[1],Ae=Object(r.useState)("month"),ze=Object(l.a)(Ae,1)[0],Fe=Object(r.useState)({startDate:"month"===ze?Object(u.Oc)():Object(u.Fc)(),endDate:"month"===ze?Object(u.kd)():Object(u.Fc)(),key:"selection"}),Pe=Object(l.a)(Fe,2),Ke=Pe[0],Re=Pe[1],Ve=Object(r.useState)([]),He=Object(l.a)(Ve,2),Be=He[0],Ue=He[1];Object(r.useEffect)((function(){!ne.loading&&ne.data&&Ue(ne.data.map((function(e){return Object(i.a)(Object(i.a)({},e),{},{createdate:Object(u.K)(null===e||void 0===e?void 0:e.createdate).toLocaleString(void 0,{year:"numeric",month:"2-digit",day:"2-digit",hour:"numeric",minute:"numeric",second:"numeric"}),changedate:Object(u.K)(null===e||void 0===e?void 0:e.createdate).toLocaleString(void 0,{year:"numeric",month:"2-digit",day:"2-digit",hour:"numeric",minute:"numeric",second:"numeric"})})})))}),[ne]);var We=Object(r.useState)(!1),Ze=Object(l.a)(We,2),Ye=Ze[0],Ge=Ze[1];Object(r.useEffect)((function(){if(Ye)if(re.loading||re.error||!re.data){if(re.error){var e=de(re.code||"error_unexpected_error",{module:de(f.a.kpimanager_plural).toLocaleLowerCase()});oe(Object(x.e)({show:!0,severity:"error",message:e})),Ge(!1),oe(Object(x.d)(!1))}}else{if(re.data[0].p_success)De((function(e){return Object(i.a)(Object(i.a)({},e),{},{previousvalue:re.data[0].p_previousvalue,currentvalue:re.data[0].p_currentvalue,updatedate:Object(u.K)(re.data[0].p_updatedate).toLocaleString(void 0,{year:"numeric",month:"2-digit",day:"2-digit",hour:"numeric",minute:"numeric",second:"numeric"})})})),Q&&Q();else{var t=de(f.a.error_kpi_sql,{error:re.data[0].p_error});oe(Object(x.e)({show:!0,severity:"error",message:t}))}Ge(!1),oe(Object(x.d)(!1))}}),[re,Ye]);var Je=[{id:"view-1",name:de(f.a.kpimanager)},{id:"view-2",name:de(f.a.kpimanager_detail)}];return Object(Z.jsx)("div",{style:{width:"100%"},children:Object(Z.jsxs)("form",{onSubmit:Ee,children:[Object(Z.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[Object(Z.jsxs)("div",{children:[Object(Z.jsx)(s.L,{breadcrumbs:Je,handleClick:function(e){oe(Object(g.g)(Object(u.Zg)(0))),J(e)}}),Object(Z.jsx)(s.R,{title:(null===U||void 0===U?void 0:U.id)?"".concat(U.kpiname):de(f.a.newkpi)})]}),Object(Z.jsxs)("div",{style:{display:"flex",gap:"10px",alignItems:"center"},children:[Object(Z.jsx)(d.a,{variant:"contained",type:"button",color:"primary",startIcon:Object(Z.jsx)(k.a,{color:"secondary"}),style:{backgroundColor:"#FB5F5F"},onClick:function(){oe(Object(g.g)(Object(u.Zg)(0))),J("view-1")},children:de(f.a.back)}),W&&Object(Z.jsx)(d.a,{className:ee.button,variant:"contained",color:"primary",type:"button",startIcon:Object(Z.jsx)(O.a,{color:"secondary"}),style:{backgroundColor:"#55BD84"},onClick:Ee,children:de(f.a.save)})]})]}),Object(Z.jsxs)(w.a,{value:ve,indicatorColor:"primary",variant:"fullWidth",style:{borderBottom:"1px solid #EBEAED",backgroundColor:"#FFF",marginTop:8},textColor:"primary",onChange:function(e,t){return je(t)},children:[Object(Z.jsx)(s.b,{label:de(f.a.detail)}),Object(Z.jsx)(s.b,{label:de(f.a.audit)}),Object(Z.jsx)(s.b,{label:de(f.a.history)})]}),0===ve&&Object(Z.jsxs)("div",{className:ee.containerDetail,children:[Object(Z.jsxs)("div",{className:"row-zyx",children:[W?Object(Z.jsx)(s.l,{label:de(f.a.kpi_name),className:"col-4",onChange:function(e){return he("kpiname",e)},valueDefault:ge("kpiname"),error:null===xe||void 0===xe||null===(t=xe.kpiname)||void 0===t?void 0:t.message}):Object(Z.jsx)(s.v,{label:de(f.a.kpiname),value:U&&U.kpiname||"",className:"col-4"}),W?Object(Z.jsx)(s.l,{label:de(f.a.description),className:"col-4",onChange:function(e){return he("description",e)},valueDefault:ge("description"),error:null===xe||void 0===xe||null===(a=xe.description)||void 0===a?void 0:a.message}):Object(Z.jsx)(s.v,{label:de(f.a.description),value:U&&U.description||"",className:"col-4"}),W?Object(Z.jsx)(s.u,{label:de(f.a.status),className:"col-4",valueDefault:ge("status"),onChange:function(e){return he("status",e?e.domainvalue:"")},error:null===xe||void 0===xe||null===(j=xe.status)||void 0===j?void 0:j.message,data:be,uset:!0,prefixTranslation:"status_",optionDesc:"domaindesc",optionValue:"domainvalue"}):Object(Z.jsx)(s.v,{label:de(f.a.status),value:U&&U.status||"",className:"col-4"})]}),["SUPERADMIN"].includes((null===$||void 0===$?void 0:$.roledesc)||"")&&Object(Z.jsxs)("div",{className:"row-zyx",children:[W?["SUPERADMIN"].includes((null===$||void 0===$?void 0:$.roledesc)||"")?Object(Z.jsx)(s.o,{label:"Select",className:"col-6",valueDefault:ge("sqlselect"),onChange:function(e){return he("sqlselect",e)},error:null===xe||void 0===xe||null===(b=xe.sqlselect)||void 0===b?void 0:b.message,disabled:!["SUPERADMIN"].includes((null===$||void 0===$?void 0:$.roledesc)||"")}):Object(Z.jsx)(s.o,{label:"Select",className:"col-6",valueDefault:U?U.sqlselect||"":null===$||void 0===$?void 0:$.corpdesc,disabled:!0}):Object(Z.jsx)(s.v,{label:"Select",value:U&&U.sqlselect||"",className:"col-6"}),W?["SUPERADMIN"].includes((null===$||void 0===$?void 0:$.roledesc)||"")?Object(Z.jsx)(s.o,{label:"Where",className:"col-6",valueDefault:ge("sqlwhere"),onChange:function(e){return he("sqlwhere",e)},error:null===xe||void 0===xe||null===(y=xe.sqlwhere)||void 0===y?void 0:y.message,disabled:!["SUPERADMIN"].includes((null===$||void 0===$?void 0:$.roledesc)||"")}):Object(Z.jsx)(s.o,{label:"Where",className:"col-6",valueDefault:U?U.sqlwhere||"":null===$||void 0===$?void 0:$.corpdesc,disabled:!0}):Object(Z.jsx)(s.v,{label:"Where",value:U&&U.sqlwhere||"",className:"col-6"})]}),Object(Z.jsxs)("div",{className:"row-zyx",children:[W?Object(Z.jsx)(s.l,{label:de(f.a.target),className:"col-4",valueDefault:ge("target"),onChange:function(e){return he("target",e)},error:null===xe||void 0===xe||null===(L=xe.target)||void 0===L?void 0:L.message,type:"number",inputProps:{min:0,step:1}}):Object(Z.jsx)(s.v,{label:de(f.a.target),value:U&&U.target||"",className:"col-4"}),W?Object(Z.jsx)(s.l,{label:de(f.a.caution_at),className:"col-4",valueDefault:ge("cautionat"),onChange:function(e){return he("cautionat",e)},error:null===xe||void 0===xe||null===(I=xe.cautionat)||void 0===I?void 0:I.message,type:"number",inputProps:{min:0,step:1}}):Object(Z.jsx)(s.v,{label:de(f.a.caution_at),value:U&&U.cautionat||"",className:"col-4"}),W?Object(Z.jsx)(s.l,{label:de(f.a.alert_at),className:"col-4",valueDefault:ge("alertat"),onChange:function(e){return he("alertat",e)},error:null===xe||void 0===xe||null===(T=xe.alertat)||void 0===T?void 0:T.message,type:"number",inputProps:{min:0,step:1}}):Object(Z.jsx)(s.v,{label:de(f.a.alert_at),value:U&&U.alertat||"",className:"col-4"})]}),Object(Z.jsxs)("div",{className:"row-zyx",children:[W?Object(Z.jsx)(s.u,{uset:!0,label:de(f.a.period),className:"col-4",valueDefault:ge("taskperiod"),onChange:function(e){return he("taskperiod",(null===e||void 0===e?void 0:e.key)||"")},error:null===xe||void 0===xe||null===(A=xe.taskperiod)||void 0===A?void 0:A.message,data:Object(u.X)(G),optionDesc:"value",optionValue:"key"}):Object(Z.jsx)(s.v,{label:de(f.a.period),value:de(G[null===U||void 0===U?void 0:U.period])||"",className:"col-12"}),W?Object(Z.jsx)(s.l,{label:de(f.a.interval),className:"col-4",type:"number",valueDefault:ge("taskinterval"),onChange:function(e){return he("taskinterval",e)},error:null===xe||void 0===xe||null===(F=xe.taskinterval)||void 0===F?void 0:F.message,inputProps:{min:0,step:1}}):Object(Z.jsx)(s.v,{label:de(f.a.interval),value:U&&U.taskinterval||1,className:"col-4"}),W?Object(Z.jsx)(s.l,{label:de(f.a.startdate),className:"col-4",type:"datetime-local",valueDefault:null===(R=ge("taskstartdate"))||void 0===R||null===(V=R.replace(" ","T"))||void 0===V?void 0:V.substring(0,16),onChange:function(e){return he("taskstartdate",e)},error:null===xe||void 0===xe||null===(H=xe.taskstartdate)||void 0===H?void 0:H.message}):Object(Z.jsx)(s.v,{label:de(f.a.startdate),value:U&&U.taskstartdate||"",className:"col-4"})]}),U&&U.id&&Object(Z.jsxs)("div",{className:"row-zyx",children:[Object(Z.jsxs)(D.a,{style:{display:"flex",justifyContent:"space-between"},children:[Object(Z.jsx)(_.a,{variant:"h6",component:"h6",children:de(f.a.graphic_detail)}),Object(Z.jsx)(d.a,{style:{border:"1px solid #bfbfc0",borderRadius:4,color:"rgb(143, 146, 161)"},onClick:function(){return Ge(!0),oe(Object(x.d)(!0)),void oe(Object(g.c)(Object(u.r)(null===U||void 0===U?void 0:U.id)))},children:de(f.a.refresh)})]}),Object(Z.jsxs)(D.a,{children:[de(f.a.last_update),": ",null===we||void 0===we?void 0:we.updatedate]}),Object(Z.jsx)(N.a,{children:Object(Z.jsxs)(C.a,{"aria-label":"simple table",children:[Object(Z.jsx)(S.a,{children:Object(Z.jsxs)(E.a,{children:[Object(Z.jsx)(M.a,{children:Object(Z.jsx)(p.a,{i18nKey:f.a.status})}),Object(Z.jsx)(M.a,{children:Object(Z.jsx)(p.a,{i18nKey:f.a.current})}),Object(Z.jsx)(M.a,{children:Object(Z.jsx)(p.a,{i18nKey:f.a.last_reading})}),Object(Z.jsx)(M.a,{children:Object(Z.jsx)(p.a,{i18nKey:f.a.target})}),Object(Z.jsx)(M.a,{children:Object(Z.jsx)(p.a,{i18nKey:f.a.variance})}),Object(Z.jsx)(M.a,{})]})}),Object(Z.jsx)(q.a,{children:Object(Z.jsxs)(E.a,{children:[Object(Z.jsx)(M.a,{children:null===U||void 0===U?void 0:U.status}),Object(Z.jsx)(M.a,{children:null===we||void 0===we?void 0:we.currentvalue}),Object(Z.jsx)(M.a,{children:null===we||void 0===we?void 0:we.previousvalue}),Object(Z.jsx)(M.a,{children:null===we||void 0===we?void 0:we.target}),Object(Z.jsx)(M.a,{children:(null===we||void 0===we?void 0:we.currentvalue)-(null===U||void 0===U?void 0:U.target)}),Object(Z.jsx)(M.a,{children:Object(Z.jsx)(P.a,{style:{width:"150px"},id:"gauge-chart",arcsLength:Ce,colors:we.target<we.alertat?["#5BE12C","#F5CD19","#EA4228"]:["#EA4228","#F5CD19","#5BE12C"],textColor:"#000000",animate:!1,percent:we.target<we.alertat?(null===we||void 0===we?void 0:we.currentvalue)/Math.max(null===we||void 0===we?void 0:we.currentvalue,10*Math.ceil(1.2*we.alertat/10)):(null===we||void 0===we?void 0:we.currentvalue)/Math.max(null===we||void 0===we?void 0:we.currentvalue,10*Math.ceil(1.2*we.target/10)),formatTextValue:function(){return""}})})]})})]})})]})]}),1===ve&&Object(Z.jsxs)("div",{className:ee.containerDetail,children:[Object(Z.jsxs)("div",{className:"row-zyx",children:[Object(Z.jsx)(s.v,{label:de(f.a.createdBy),value:ge("createby"),className:"col-6"}),Object(Z.jsx)(s.v,{label:de(f.a.creationDate),value:(null===U||void 0===U?void 0:U.createdate)&&Object(u.K)(ge("createdate")).toLocaleString(void 0,{year:"numeric",month:"2-digit",day:"2-digit",hour:"numeric",minute:"numeric",second:"numeric"}),className:"col-6"})]}),Object(Z.jsxs)("div",{className:"row-zyx",children:[Object(Z.jsx)(s.v,{label:de(f.a.change_by),value:ge("changeby"),className:"col-6"}),Object(Z.jsx)(s.v,{label:de(f.a.change_date),value:(null===U||void 0===U?void 0:U.changedate)&&Object(u.K)(ge("changedate")).toLocaleString(void 0,{year:"numeric",month:"2-digit",day:"2-digit",hour:"numeric",minute:"numeric",second:"numeric"}),className:"col-6"})]})]}),2===ve&&Object(Z.jsx)("div",{className:ee.containerDetail,children:Object(Z.jsx)(v.f,{ButtonsElement:function(){return Object(Z.jsxs)("div",{style:{display:"flex",flexWrap:"wrap",gap:8},children:[Object(Z.jsx)(s.f,{open:Ie,setOpen:Te,range:Ke,onSelect:Re,children:Object(Z.jsx)(d.a,{disabled:ne.loading,style:{border:"1px solid #bfbfc0",borderRadius:4,color:"rgb(143, 146, 161)"},startIcon:Object(Z.jsx)(z.n,{}),onClick:function(){return Te(!Ie)},children:Object(u.Ec)(Ke.startDate)+" - "+Object(u.Ec)(Ke.endDate)})}),Object(Z.jsx)(d.a,{disabled:ne.loading,variant:"contained",color:"primary",startIcon:Object(Z.jsx)(K.a,{style:{color:"white"}}),style:{backgroundColor:"#55BD84",width:120},onClick:function(){oe(Object(g.h)(Object(u.ah)({kpiid:null===U||void 0===U?void 0:U.id,startdate:Ke.startDate,enddate:Ke.endDate})))},children:Object(Z.jsx)(p.a,{i18nKey:f.a.search})})]})},columns:Me,data:Be,download:!0,filterrange:!0,pageSizeDefault:50})})]})})},X=function(e){var t=e.onDelete,a=e.onDuplicate,i=e.onCalc,r=n.a.useState(null),c=Object(l.a)(r,2),o=c[0],d=c[1],s=Object(m.a)().t;return Object(Z.jsxs)(Z.Fragment,{children:[Object(Z.jsx)(L.a,{"aria-label":"more","aria-controls":"long-menu","aria-haspopup":"true",size:"small",onClick:function(e){e.stopPropagation(),d(e.currentTarget)},children:Object(Z.jsx)(V.a,{})}),Object(Z.jsxs)(I.a,{id:"menu-appbar",anchorEl:o,getContentAnchorEl:null,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},open:Boolean(o),onClick:function(e){return e.stopPropagation()},onClose:function(){return d(null)},children:[t&&Object(Z.jsxs)(T.a,{onClick:function(e){e.stopPropagation(),d(null),t()},children:[Object(Z.jsx)(A.a,{color:"inherit",children:Object(Z.jsx)(B.a,{width:18,style:{fill:"#7721AD"}})}),s(f.a.delete)]}),a&&Object(Z.jsxs)(T.a,{onClick:function(e){e.stopPropagation(),d(null),a()},children:[Object(Z.jsx)(A.a,{children:Object(Z.jsx)(z.G,{width:18,style:{fill:"#7721AD"}})}),s(f.a.duplicate)]}),i&&Object(Z.jsxs)(T.a,{onClick:function(e){e.stopPropagation(),d(null),i()},children:[Object(Z.jsx)(A.a,{children:Object(Z.jsx)(W.a,{width:18,style:{fill:"#7721AD"}})}),s(f.a.calculate)]})]})]})};t.default=function(){var e=Object(o.c)(),t=Object(m.a)().t,a=Object(c.b)((function(e){return e.main})),d=Object(c.b)((function(e){return e.main.execute})),s=Object(r.useState)("view-1"),j=Object(l.a)(s,2),b=j[0],O=j[1],p=Object(r.useState)({row:null,edit:!1}),h=Object(l.a)(p,2),y=h[0],k=h[1],w=Object(r.useState)(!1),D=Object(l.a)(w,2),_=D[0],N=D[1],C=Object(r.useState)(!1),S=Object(l.a)(C,2),E=S[0],M=S[1],q=Object(r.useState)(!1),L=Object(l.a)(q,2),I=L[0],T=L[1],A=Object(r.useState)([]),z=Object(l.a)(A,2),F=z[0],P=z[1];Object(r.useEffect)((function(){P(a.mainData.data.map((function(e){return Object(i.a)(Object(i.a)({},e),{},{updatedate:Object(u.K)(e.updatedate).toLocaleString(void 0,{year:"numeric",month:"2-digit",day:"2-digit",hour:"numeric",minute:"numeric",second:"numeric"})})})))}),[a.mainData.data]);var K=n.a.useMemo((function(){return[{accessor:"id",NoFilter:!0,isComponent:!0,minWidth:60,width:"1%",Cell:function(e){var t=e.cell.row.original;return Object(Z.jsx)(X,{onDelete:function(){V(t)},onDuplicate:function(){H(t)},onCalc:function(){B(t)}})}},{Header:t(f.a.kpiname),accessor:"kpiname",NoFilter:!0},{Header:t(f.a.description),accessor:"description",NoFilter:!0},{Header:t(f.a.current_value),accessor:"currentvalue",type:"number",NoFilter:!0},{Header:t(f.a.target),accessor:"target",type:"number",NoFilter:!0},{Header:t(f.a.last_update),accessor:"updatedate",NoFilter:!0},{Header:t(f.a.status),accessor:"status",NoFilter:!0,prefixTranslation:"status_",Cell:function(e){var a=e.cell.row.original.status;return(t("status_".concat(a).toLowerCase())||"").toUpperCase()}}]}),[]),R=function(){return e(Object(g.g)(Object(u.Zg)(0)))};Object(r.useEffect)((function(){return R(),e(Object(g.p)([Object(u.Ke)("ESTADOGENERICO")])),function(){e(Object(g.t)())}}),[]),Object(r.useEffect)((function(){if(_)if(d.loading||d.error){if(d.error){var a=t(d.code||"error_unexpected_error",{module:t(f.a.kpimanager_plural).toLocaleLowerCase()});e(Object(x.e)({show:!0,severity:"error",message:a})),e(Object(x.d)(!1)),N(!1)}}else e(Object(x.e)({show:!0,severity:"success",message:t(f.a.successful_delete)})),R(),e(Object(x.d)(!1)),N(!1)}),[d,_]);var V=function(a){e(Object(x.a)({visible:!0,question:t(f.a.confirmation_delete),callback:function(){e(Object(g.c)(Object(u.Zf)(Object(i.a)(Object(i.a)({},a),{},{operation:"DELETE",status:"ELIMINADO",id:a.id})))),e(Object(x.d)(!0)),N(!0)}}))},H=function(e){O("view-2"),k({row:{kpiname:e.kpiname,description:e.description,status:e.status,type:e.type,sqlselect:e.sqlselect,sqlwhere:e.sqlwhere,target:e.target,cautionat:e.cautionat,alertat:e.alertat,taskperiod:e.taskperiod,taskinterval:e.taskinterval,taskstartdate:e.taskstartdate},edit:!0})},B=function(t){e(Object(g.c)(Object(u.r)(null===t||void 0===t?void 0:t.id))),e(Object(x.d)(!0)),T(!0)};return Object(r.useEffect)((function(){if(E)if(d.loading||d.error){if(d.error){var a=t(d.code||"error_unexpected_error",{module:t(f.a.kpimanager_plural).toLocaleLowerCase()});e(Object(x.e)({show:!0,severity:"error",message:a})),e(Object(x.d)(!1)),M(!1)}}else e(Object(x.e)({show:!0,severity:"success",message:t(f.a.successful_duplicate)})),R(),e(Object(x.d)(!1)),M(!1)}),[d,E]),Object(r.useEffect)((function(){if(I)if(d.loading||d.error||!d.data){if(d.error){var a=t(d.code||"error_unexpected_error",{module:t(f.a.kpimanager_plural).toLocaleLowerCase()});e(Object(x.e)({show:!0,severity:"error",message:a})),e(Object(x.d)(!1)),T(!1)}}else{if(d.data[0].p_success)R&&R();else{var i=t(f.a.error_kpi_sql,{error:d.data[0].p_error});e(Object(x.e)({show:!0,severity:"error",message:i}))}e(Object(x.d)(!1)),T(!1)}}),[d,I]),"view-1"===b?Object(Z.jsx)(v.f,{onClickRow:function(e){O("view-2"),k({row:e,edit:!0})},columns:K,titlemodule:t(f.a.kpimanager_plural,{count:2}),data:F,download:!0,loading:a.mainData.loading,register:!0,handleRegister:function(){O("view-2"),k({row:null,edit:!0})}}):"view-2"===b?Object(Z.jsx)(J,{data:y,setViewSelected:O,multiData:a.multiData.data,fetchData:R}):null}},778:function(e,t,a){"use strict";var i=a(45),l=a(61);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=l(a(0)),n=(0,i(a(62)).default)(r.createElement("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Clear");t.default=n},780:function(e,t,a){"use strict";var i=a(45),l=a(61);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=l(a(0)),n=(0,i(a(62)).default)(r.createElement("path",{d:"M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7l-4-4zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3zm3-10H5V5h10v4z"}),"Save");t.default=n}}]);
//# sourceMappingURL=66.33e0f83c.chunk.js.map